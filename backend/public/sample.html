<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sample PMS - Guests, Users, Room Types, Rooms</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      padding: 6px;
    }
    h1, h2 {
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <!-- Guest Section -->
  <h1>Add Guest</h1>
  <form id="guestForm">
    <input type="text" id="first_name" placeholder="First Name" required />
    <input type="text" id="last_name" placeholder="Last Name" required />
    <input type="text" id="guest_email" placeholder="Email" required />
    <button type="submit">Add Guest</button>
  </form>
  <h2>Guest List</h2>
  <table id="guestTable"><thead><tr><th>ID</th><th>Name</th><th>Email</th></tr></thead><tbody></tbody></table>

  <!-- User Section -->
  <h1>Add User</h1>
  <form id="userForm">
    <input type="text" id="user_name" placeholder="Name" required />
    <input type="text" id="user_email" placeholder="Email" required />
    <input type="text" id="user_password" placeholder="Password" required />
    <button type="submit">Add User</button>
  </form>
  <h2>User List</h2>
  <table id="userTable"><thead><tr><th>ID</th><th>Name</th><th>Email</th></tr></thead><tbody></tbody></table>

  <!-- Room Type Section -->
  <h1>Add Room Type</h1>
  <form id="roomTypeForm">
    <input type="text" id="room_category" placeholder="Category" required />
    <input type="text" id="description" placeholder="Description" required />
    <input type="number" id="price" placeholder="Price" required />
    <input type="number" id="no_guest" placeholder="# of Guests" required />
    <input type="number" id="additional_guest_price" placeholder="Add. Guest Price" required />
    <button type="submit">Add Room Type</button>
  </form>
  <h2>Room Type List</h2>
  <table id="roomTypeTable"><thead><tr><th>ID</th><th>Category</th><th>Price</th></tr></thead><tbody></tbody></table>

  <!-- Room Section -->
  <h1>Add Room</h1>
  <form id="roomForm">
    <input type="number" id="room_type_id" placeholder="Room Type ID" required />
    <input type="text" id="room_number" placeholder="Room Number" required />
    <button type="submit">Add Room</button>
  </form>
  <h2>Room List</h2>
  <table id="roomTable"><thead><tr><th>ID</th><th>Room Number</th><th>Type</th><th>Price</th></tr></thead><tbody></tbody></table>

  <script>
    // Forms
    const guestForm = document.getElementById('guestForm');
    const userForm = document.getElementById('userForm');
    const roomTypeForm = document.getElementById('roomTypeForm');
    const roomForm = document.getElementById('roomForm');

    // Tables
    const guestTable = document.querySelector('#guestTable tbody');
    const userTable = document.querySelector('#userTable tbody');
    const roomTypeTable = document.querySelector('#roomTypeTable tbody');
    const roomTable = document.querySelector('#roomTable tbody');

    window.onload = async () => {
      await loadGuests();
      await loadUsers();
      await loadRoomTypes();
      await loadRooms();
    };

    // Guests
    async function loadGuests() {
      const res = await fetch('/api/guests');
      const guests = await res.json();
      guestTable.innerHTML = '';
      guests.forEach(g => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${g.guest_id}</td><td>${g.first_name} ${g.last_name}</td><td>${g.guest_email}</td>`;
        guestTable.appendChild(row);
      });
    }

    guestForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const first_name = document.getElementById('first_name').value;
      const last_name = document.getElementById('last_name').value;
      const guest_email = document.getElementById('guest_email').value;
      await fetch('/api/guests', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ first_name, last_name, guest_email })
      });
      guestForm.reset();
      await loadGuests();
    });

    // Users
    async function loadUsers() {
      const res = await fetch('/api/users');
      const users = await res.json();
      userTable.innerHTML = '';
      users.forEach(u => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${u.user_id}</td><td>${u.name}</td><td>${u.user_email}</td>`;
        userTable.appendChild(row);
      });
    }

    userForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('user_name').value;
      const user_email = document.getElementById('user_email').value;
      const password = document.getElementById('user_password').value;
      await fetch('/api/users', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, user_email, password })
      });
      userForm.reset();
      await loadUsers();
    });

    // Room Types
    async function loadRoomTypes() {
      const res = await fetch('/api/roomtypes');
      const types = await res.json();
      roomTypeTable.innerHTML = '';
      types.forEach(rt => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${rt.room_type_id}</td><td>${rt.room_category}</td><td>${rt.price}</td>`;
        roomTypeTable.appendChild(row);
      });
    }

    roomTypeForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const room_category = document.getElementById('room_category').value;
      const description = document.getElementById('description').value;
      const price = parseFloat(document.getElementById('price').value);
      const no_guest = parseInt(document.getElementById('no_guest').value);
      const additional_guest_price = parseFloat(document.getElementById('additional_guest_price').value);
      await fetch('/api/room-types', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ room_category, description, price, no_guest, additional_guest_price })
      });
      roomTypeForm.reset();
      await loadRoomTypes();
    });

    // Rooms
    async function loadRooms() {
      const res = await fetch('/api/rooms');
      const rooms = await res.json();
      roomTable.innerHTML = '';
      rooms.forEach(r => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${r.room_id}</td><td>${r.room_number}</td><td>${r.room_category}</td><td>${r.price}</td>`;
        roomTable.appendChild(row);
      });
    }

    roomForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const room_type_id = parseInt(document.getElementById('room_type_id').value);
      const room_number = document.getElementById('room_number').value;
      await fetch('/api/rooms', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ room_type_id, room_number })
      });
      roomForm.reset();
      await loadRooms();
    });
  </script>
</body>
</html>
